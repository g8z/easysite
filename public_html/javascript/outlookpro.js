// Title: COOLjsOutlookBar PRO
// URL: http://javascript.cooldev.com/scripts/outlookpro/
// Version: 1.0.8
// Last Modify: 28 September 2004
// Notes: Registration needed to use this script on your web site.
// Author: Helena Nikitina
// Copyright (c) 2003-2004 by CoolDev.Com

var _n=-1,_6=-1,_M=false;function COOLjsOutlookBarPRO(_3){bw=new _1d();window.$bar=this;this._3=_3;this._s=false;this._j=0;this._C=0;this._D='';window.onload=function(){window.$bar._b()};window.onunload=function(){window.$bar._a()};window.onresize=function(){if(bw.ns4)document.location.reload();else window.$bar._o()};document.onselect=function(){return false};document.onmousewheel=function(){if(_6!=-1){_M=true;window.$bar._7[_6]._z(event.wheelDelta<0?+1:-1)}};if(bw.operaOld){$iw=innerWidth;$ih=innerHeight;$tiw=top.innerWidth;$tih=top.innerHeight;window.setInterval('if($iw!=innerWidth||$ih!=innerHeight||$tiw!=top.innerWidth||$tih!=top.innerHeight)document.location.reload();',300)};this.$panels=this._7=[];for(var i=0;i<this._3.panels.length;i++)this._7[i]=new _U(this,i);document.write('<div id="dummyNN4Layer" style="left: 0; top: 0;"></div>'+this._D)};$=COOLjsOutlookBarPRO.prototype;$._12=function(_u,_w){window.open(_u,_w||this._3.format.target)};$._b=function(){for(var i=0;i<this._7.length;i++)this._7[i]._b();this._17()};$._a=function(){for(var i=0;i<this._7.length;i++)this._7[i]._a()};$._16=function(_14){this._D+=_14};$._19=function(){document.cookie='cjsobp_panel='+(_6>=0&&_6<this._7.length?_6+','+this._7[_6]._8:'')};$._17=function(){var _V=this._3.format.defaultPanel||0,_r=_V,_8=0;if(document.cookie.match(/cjsobp_panel=(\d)+,(\d+)/)){_r=parseInt(RegExp.$1);_8=parseInt(RegExp.$2);if(_r>=this._7.length)_r=_V};if(_r>=this._7.length)_r=0;this._7[_r]._R(_8)};$._10=function(){if(this._I){window.clearTimeout(this._I);this._s=false;this._o()};this._j=0;this._s=true};$.$update=$._o=function(_d){for(var i=0;i<this._7.length;i++)this._7[i]._o(this._s&&_d);if(this._s)if(this._j<1000){this._j=Math.round(Math.min(this._j+1000/this._3.format.animationSteps,1000));this._I=window.setTimeout('window.$bar.$update('+_d+')',this._3.format.animationDelay)}else{this._j=0;this._s=false;this._I=null;this._o();this._19();if(!_d&&_6!=-1&&this._C){if(!_M)this._7[_6]._z(this._C);_M=false}}};$._1a=function(){return(bw.ie&&document.body.offsetHeight||(innerHeight+(bw.ns4?4:0)))};$._e=function(){var _k=this._1a();for(var i=0;i<this._7.length;i++)_k-=this._7[i]._2.h;return _k};$._W=function(_1f){return Math.round(_1f*(1000-this._j)/1000)};function _x(_t,_v,_l,_q){this._g=0;this._y=false;this._0=[new _m(),new _m(),new _m(),new _m(true)];this._0[0]._E(_t,0,_v*2,this._F(_l.normal,_q,_l.common));this._0[1]._E(_t,0,_v*2,this._F(_l.rollovered||_l.normal,_q,_l.common));this._0[2]._E(_t,0,_v*2,this._F(_l.clicked||_l.rollovered||_l.normal,_q,_l.common));this._0[3]._E(_t,10,_v*2+1,bw.realDom?'<img src="'+window.$bar._3.format.blankImage+'" width="100%" height="100%" />':'')};$=_x.prototype;$._b=function(){this._0[0]._b();this._0[1]._b();this._0[2]._b();this._0[3]._b();with(this._0[0]){this.x=x;this.y=y;this.w=w;this.h=h};this._0[3].el._h=this;this._0[3].el.onmouseover=function(){if(bw.ns4)this.captureEvents(Event.MOUSEDOWN|Event.MOUSEUP);this._T=true;this._h._H(this._X?2:1);this._h._18()};this._0[3].el.onmouseout=function(){if(bw.ns4)this.releaseEvents(Event.MOUSEDOWN|Event.MOUSEUP);this._T=false;this._h._H(0);this._h._Q()};this._0[3].el.onmousedown=function(){this._X=true;this._h._H(2);this._h._J()};this._0[3].el.onmouseup=function(){this._X=false;this._h._H(this._T?1:0);if(bw.ns4)this.onclick();this._h._K()};this._0[3].el.onclick=function(){this._h._N()};if(bw.realDom){this._0[0]._f();this._0[0]._c();this._0[1]._f();this._0[1]._c();this._0[2]._f();this._0[2]._c()}};$._a=function(){this._0[0]._a();this._0[1]._a();this._0[2]._a();this._0[3]._a()};$._18=$._Q=$._J=$._K=$._N=function(){};$._H=function(_g){if(this._g!=_g){if(this._y){this._0[_g]._f();this._0[this._g]._c()};this._g=_g}};$._f=function(){if(!this._y){this._0[this._g]._f();this._0[3]._f();this._y=true};this._0[3]._1e(this.h=this._0[this._g]._P())};$._c=function(){if(this._y){this._0[this._g]._c();this._0[3]._c();this._y=false}};$._i=function(_x,_y){this._0[0]._i(_x,_y);this._0[1]._i(_x,_y);this._0[2]._i(_x,_y);this._0[3]._i(_x,_y);this.x=_x;this.y=_y};$._F=function(_p,_q,_1b){if(typeof(_p)=='object')_p=this._F(_1b,_p);for(var _O in _q)while(_p.indexOf('{'+_O+'}')!=-1)_p=_p.replace('{'+_O+'}',_q[_O]);return _p};function _U(_1,_4){this._1=_1;this._4=_4;this._8=0;var _3=this._1._3.panels[this._4];this._u=_3.url;this._w=_3.target;this._2=new _x(bw.ns4?null:'100%',3,this._1._3.format.templates.panel,_3);this._2._9=this;this._2._N=function(){if(this._9._15()){this._9._1._10();this._9._R(0)};if(this._9._u)window.$bar._12(this._9._u,this._9._w)};this._5=[];for(var i=0;i<this._1._3.panels[this._4].items.length;i++){var _3=this._1._3.panels[this._4].items[i];this._5[i]=new _x(bw.ns4?null:'100%',1,this._1._3.format.templates.item,_3);if(_3.url){this._5[i]._u=_3.url;this._5[i]._w=_3.target;this._5[i]._9=this;this._5[i]._N=function(){if(window.$bar._e()>=this.h&&!this._9._B(this,true))this._9._z(+1);window.$bar._12(this._u,this._w)}}};this.arr_up=new _x('auto',2,this._1._3.format.templates.upArrow,{});this.arr_up._9=this;this.arr_up._J=function(){this._9._z(-1)};this.arr_dn=new _x('auto',2,this._1._3.format.templates.downArrow,{});this.arr_dn._9=this;this.arr_dn._J=function(){this._9._z(+1)};this.arr_up._Q=this.arr_up._K=this.arr_dn._Q=this.arr_dn._K=function(){this._9._1._C=0}};$=_U.prototype;$._b=function(){this._2._b();for(var i=0;i<this._5.length;i++)this._5[i]._b();this.arr_up._b();this.arr_dn._b()};$._a=function(){this._2._a();for(var i=0;i<this._5.length;i++)this._5[i]._a();this.arr_up._a();this.arr_dn._a()};$.__=function(){return bw.ie&&document.body.offsetWidth||innerWidth};$._B=function(_2,_1c){if(_1c)return _2.y>=this._2.y&&(this._4==this._1._7.length-1||_2.y+_2.h-1<this._1._7[this._4+1]._2.y+this._1._7[this._4+1]._2.h);else return(_2.y>=this._2.y+this._2.h&&_2.y<this._2.y+this._2.h+this._1._e())||(_2.y+_2.h>=this._2.y+this._2.h&&_2.y+_2.h<this._2.y+this._2.h+this._1._e())};$._13=function(_S){var _k=0;for(var i=0;i<this._4;i++)_k+=this._1._7[i]._2.h;if(_S>=0&&this._4>_S)_k+=this._1._e();return _k};$.$update=$._o=function(_d){var _y=this._13(_6);this._2._i(0,_y+(_d?this._1._W(this._13(_n)-_y):0));this._2._f();if(_6==this._4||(_d&&_n==this._4)){if(this._A()<this._1._e())while(this._8>0){this._8--;if(this._A()>this._1._e()){this._8++;break}else if(this._A()>=this._1._e())break};_y+=this._2.h;if(this._1._j==0){this._dy=0;if(_d){if(this._4==_6){if(_6>_n&&_n!=-1)this._dy=this._1._e()}else{if(_n<_6||_6==-1)return;else this._dy=-this._1._e()}}else if(this._1._s)this._dy=this._5[this._8].y-_y};for(var i=0;i<this._8;i++)_y-=this._5[i].h;_y+=this._1._W(this._dy);for(var i=0;i<this._5.length;i++){this._5[i]._i(0,_y);if(this._B(this._5[i],_d))this._5[i]._f();else this._5[i]._c();_y+=this._5[i].h}}else if(_n==this._4)for(var i=0;i<this._5.length;i++)this._5[i]._c();this.arr_up._i(this.__()-this.arr_up.w,this._2.y+this._2.h);this.arr_dn._i(this.__()-this.arr_dn.w,this._2.y+this._2.h+this._1._e()-this.arr_dn.h);if(this._Y())this.arr_up._f();else if(!_d||this._1._j==1000)this.arr_up._c();if(!this._B(this.arr_up,_d))this.arr_up._c();if(this._11())this.arr_dn._f();else if(!_d||this._1._j==1000)this.arr_dn._c();if(!this._B(this.arr_dn,_d))this.arr_dn._c()};$._z=function(_L){if(_L<0?this._Y():this._11()){this._1._C=_L;this._1._10();this._8+=_L;this._1._o()}};$._A=function(){var _k=0;for(var i=this._8;i<this._5.length;i++)_k+=this._5[i].h;return _k};$._11=function(){return this._8<this._5.length-1&&_6==this._4&&this._A()>this._1._e()};$._Y=function(){return this._8>0&&_6==this._4};$._15=function(){return _6!=this._4||this._1._3.format.rollback};$._R=function(_8){if(_6==this._4){if(this._1._3.format.rollback){_n=this._4;_6=-1}else return}else{_n=_6;_6=this._4};this._8=_8;this._1._o(true)};function _1d(){this.ver=navigator.appVersion;this.agent=navigator.userAgent;this.dom=document.getElementById?1:0;this.opera5=this.agent.indexOf("Opera 5")>-1;this.ie5=this.ver.indexOf("MSIE 5")>-1&&this.dom&&!this.opera5;this.ie6=this.ver.indexOf("MSIE 6")>-1&&this.dom&&!this.opera5;this.ie4=(document.all&&!this.dom&&!this.opera5)?1:0;this.ie=this.ie4||this.ie5||this.ie6;this.opera7=((this.agent.toLowerCase().indexOf('opera 7')>-1)||(this.agent.toLowerCase().indexOf('opera/7')>-1));this.opera=window.opera;this.operaOld=this.opera&&!this.opera7;this.realDom=this.dom&&!this.operaOld;this.ns4=document.layers&&!this.dom&&!this.operaOld};function _m(_G){if(!_m._4)_m._4=0;this.id='do_'+(_m._4++);this._G=_G};$=_m.prototype;$._b=function(){this.el=bw.dom?document.getElementById(this.id):bw.ie4?document.all[this.id]:bw.ns4?document.layers[this.id]:0;this.css=bw.dom||bw.ie4?this.el.style:this.el;this.doc=bw.dom||bw.ie4?document:this.css.document;this.x=parseInt(this.css.left)||this.css.pixelLeft||this.el.offsetLeft||0;this.y=parseInt(this.css.top)||this.css.pixelTop||this.el.offsetTop||0;this.w=this._Z();this.h=this._P()};$._a=function(){this.el=null;this.css=null;this.doc=null};$._Z=function(){return this.el.offsetWidth||this.css.clip.width||this.doc.width||this.css.pixelWidth||0};$._P=function(){return this.el.offsetHeight||this.css.clip.height||this.doc.height||this.css.pixelHeight||0};$._i=function(_x,_y){this.x=_x;this.y=_y;if(this.el){var px=bw.ns4||bw.operaOld?0:'px';this.css.left=_x+px;this.css.top=_y+px}};$._1e=function(_h){this.h=_h;if(this.el){if(bw.ns4)this.el.resize(this.w,_h);else{var px=bw.operaOld?0:'px';this.css.height=_h+px}}};$._f=function(){if(bw.realDom&&!this.el&&!this._G){this.el=document.createElement('DIV');this.el.innerHTML=this._D;this.el.style.position='absolute';this.el.style.width=this._t||(this.w+'px');this.el.style.left=this.x+'px';this.el.style.top=this.y+'px';this.el.style.zIndex=this._v;document.body.appendChild(this.el,'beforeEnd');this.css=this.el.style;this.w=this._Z();this.h=this._P()};this.css.visibility=bw.ns4?'show':"visible"};$._c=function(){this.css.visibility=bw.ns4?'hide':"hidden";if(bw.realDom&&this.el&&!this._G){this.el.parentNode.removeChild(this.el);this.el.innerHTML='';this.css=null;this.el=null}};$._E=function(w,h,z,_$){this._D=_$;this._v=z;this._t=w;window.$bar._16('<div ondrag="return false" id="'+this.id+'" style="position:absolute; z-index:'+z+';left: 0; top: 0;'+(w?' width: '+w+'; ':'')+'height: auto; visibility:hidden;">'+_$+'</div>')}